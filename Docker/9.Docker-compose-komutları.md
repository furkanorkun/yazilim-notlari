# Docker Compose Terminal Komutları Rehberi

Docker Compose, çoklu konteyner uygulamalarını yönetmek için kullanılan güçlü bir araçtır. İşte en çok kullanılan komutlar ve gerçek dünya örnekleri:

## Temel Komutlar

### docker compose up
Servisleri başlatır ve konteynerleri oluşturur.

```bash
# Tüm servisleri başlat
docker compose up

# Arka planda çalıştır (detached mode)
docker compose up -d

# Belirli bir servisi başlat
docker compose up api
```

**Gerçek dünya örneği:**
```bash
# .NET API + React + SQL Server stack'ini başlatma
docker compose up -d
# Çıktı: API localhost:5000'de, React localhost:3000'de, SQL localhost:1433'te hazır
```
### docker compose down
Servisleri durdurur ve konteynerleri, networkleri kaldırır.

```bash
# Servisleri durdur ve temizle
docker compose down

# Volume'ları da sil (dikkatli kullan!)
docker compose down -v

# Image'ları da sil
docker compose down --rmi all
```

**Gerçek dünya örneği:**
```bash
# Geliştirme ortamını tamamen temizleme
docker compose down -v
# SQL veritabanı verileri de silinir
```
docker compose ps
Çalışan servisleri listeler.
bashdocker compose ps

# Tüm konteynerleri göster (durmuş olanlar dahil)
docker compose ps -a
```

**Çıktı örneği:**
```
NAME                SERVICE    STATUS       PORTS
myapp-api-1        api        running      0.0.0.0:5000->80/tcp
myapp-frontend-1   frontend   running      0.0.0.0:3000->3000/tcp
myapp-db-1         db         running      0.0.0.0:1433->1433/tcp
docker compose logs
Konteyner loglarını görüntüler.
bash# Tüm servislerin logları
docker compose logs

# Belirli bir servisin logları
docker compose logs api

# Canlı takip (follow)
docker compose logs -f

# Son 100 satır
docker compose logs --tail=100 api
Gerçek dünya örneği:
bash# .NET API'nin hata loglarını takip etme
docker compose logs -f api

# React build hatalarını görme
docker compose logs frontend | grep "ERROR"
### docker compose exec
Çalışan bir konteynerde komut çalıştırır.

```bash
# API konteynerinde bash açma
docker compose exec api bash

# SQL Server'da sorgu çalıştırma
docker compose exec db /opt/mssql-tools/bin/sqlcmd -S localhost -U sa -P YourPassword

# .NET migration çalıştırma
docker compose exec api dotnet ef database update
```

**Gerçek dünya örneği:**
```bash
# React konteynerinde npm paket yükleme
docker compose exec frontend npm install axios

# SQL backup alma
docker compose exec db /opt/mssql-tools/bin/sqlcmd -S localhost -U sa -P Pass@123 -Q "BACKUP DATABASE MyDb TO DISK='/var/opt/mssql/backup/mydb.bak'"
```
### docker compose build
Servislerin image'larını yeniden build eder.

```bash
# Tüm servisleri build et
docker compose build

# Cache kullanmadan build et
docker compose build --no-cache

# Belirli bir servisi build et
docker compose build api
```

**Gerçek dünya örneği:**
```bash
# .NET API'de kod değişikliği sonrası yeniden build
docker compose build api
docker compose up -d api
```

### docker compose restart
Servisleri yeniden başlatır.

```bash
# Tüm servisleri restart et
docker compose restart

# Belirli bir servisi restart et
docker compose restart api
```

### docker compose stop ve docker compose start
Servisleri durdurur/başlatır (silmeden).

```bash
# Servisleri durdur
docker compose stop

# Servisleri başlat
docker compose start

# Belirli servisi durdur
docker compose stop db
```
## Gerçek Dünya Senaryoları

### Senaryo 1: .NET API + React + SQL Server Geliştirme Ortamı

```yaml
# docker-compose.yml
version: '3.8'

services:
  db:
    image: mcr.microsoft.com/mssql/server:2022-latest
    environment:
      - ACCEPT_EULA=Y
      - SA_PASSWORD=MyStrongPass123!
    ports:
      - "1433:1433"
    volumes:
      - sqldata:/var/opt/mssql

  api:
    build: ./MyApi
    ports:
      - "5000:80"
    environment:
      - ConnectionStrings__DefaultConnection=Server=db;Database=MyDb;User=sa;Password=MyStrongPass123!;TrustServerCertificate=True
    depends_on:
      - db

  frontend:
    build: ./my-react-app
    ports:
      - "3000:3000"
    environment:
      - REACT_APP_API_URL=http://localhost:5000
    volumes:
      - ./my-react-app/src:/app/src

volumes:
  sqldata:
```

**Kullanım akışı:**
```bash
# 1. İlk kurulum
docker compose up -d

# 2. API'de migration çalıştırma
docker compose exec api dotnet ef database update

# 3. Logları kontrol etme
docker compose logs -f api

# 4. Frontend'de hot reload aktif, dosyaları düzenle

# 5. SQL'de bir tablo kontrolü
docker compose exec db /opt/mssql-tools/bin/sqlcmd -S localhost -U sa -P MyStrongPass123! -Q "SELECT * FROM Users"

# 6. Güncellemelerden sonra API'yi rebuild
docker compose build api
docker compose up -d api

# 7. Gün sonu - her şeyi durdur
docker compose stop

# 8. Ertesi gün - devam et
docker compose start
```
### Senaryo 2: React Development ile Hot Reload

```bash
# React uygulamasını geliştirme modunda başlatma
docker compose up frontend

# Değişiklikleri gerçek zamanlı görme
# src/ klasöründe değişiklik yap, tarayıcı otomatik yenilenir

# Package.json güncellemesi sonrası
docker compose down frontend
docker compose build --no-cache frontend
docker compose up -d frontend
```

### Senaryo 3: .NET API Debug ve Test

```bash
# API'yi debug mode'da başlat
docker compose up api

# Başka terminalde - integration test çalıştır
docker compose exec api dotnet test

# Code coverage raporu al
docker compose exec api dotnet test /p:CollectCoverage=true

# Belirli bir test çalıştır
docker compose exec api dotnet test --filter FullyQualifiedName~UserServiceTests
```

### Senaryo 4: Veritabanı Yönetimi

```bash
# SQL Server'a bağlan
docker compose exec db /opt/mssql-tools/bin/sqlcmd -S localhost -U sa -P MyStrongPass123!

# Backup al
docker compose exec db /opt/mssql-tools/bin/sqlcmd -S localhost -U sa -P MyStrongPass123! -Q "BACKUP DATABASE MyDb TO DISK='/var/opt/mssql/backup/mydb.bak'"

# Backup'ı host'a kopyala
docker compose cp db:/var/opt/mssql/backup/mydb.bak ./backups/

# Database'i sıfırla (dikkatli!)
docker compose down -v
docker compose up -d db
docker compose exec api dotnet ef database update
```

## Yararlı Kombinasyonlar

```bash
# Hızlı restart ve log takibi
docker compose restart api && docker compose logs -f api

# Build ve çalıştır
docker compose build api && docker compose up -d api

# Tüm konteynerleri temizle ve yeniden başlat
docker compose down && docker compose up -d

# Servis durumunu ve kaynak kullanımını gör
docker compose ps && docker stats
```

## İpuçları

- **Development için volume mount kullan:** Kod değişiklikleri anında yansır
- **Production için build kullan:** Image'lar optimize edilir
- **Her zaman -d flag'i kullanmayın:** Başlangıçta logları görmek önemli
- **depends_on kullanın:** Servislerin doğru sırayla başlamasını sağlar
- **Health check ekleyin:** Servislerin gerçekten hazır olmasını bekleyin

Docker Compose, .NET, React ve SQL Server stack'i için ideal bir geliştirme ortamı sağlar. Tek bir komutla tüm altyapınız ayağa kalkar ve tutarlı bir ortam elde edersiniz.