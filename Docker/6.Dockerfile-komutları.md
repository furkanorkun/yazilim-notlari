Bir Dockerfile yazarken onlarca komut olsa da, gerçek hayatta (özellikle kurumsal projelerde) %90 oranında sadece aşağıdaki 7 temel komutu kullanırsınız. Bir Full-Stack (.NET + React) geliştirici olarak bu komutları nasıl kullanacağınızı, nedenleriyle birlikte aşağıda listeledim.

## 1. FROM

### Nedir
Her Dockerfile bu komutla başlamak zorundadır. Yemeğin yapılacağı tencereyi (İşletim Sistemi + Çatıyı) seçer.

### Neden Kullanılır
Sıfırdan bir işletim sistemi yazamayız. Hazır, denenmiş bir alt yapı üzerine inşa etmek için kullanılır.

| Teknoloji | Örnek Kullanım | Açıklama |
|-----------|----------------|----------|
| .NET | `FROM mcr.microsoft.com/dotnet/sdk:8.0` | Uygulamayı derlemek (build) için içinde tüm araçların (SDK) olduğu imaj. |
| React | `FROM node:20-alpine` | "Alpine" ifadesi çok önemlidir; gereksiz araçlardan arındırılmış, çok küçük (5-10MB) bir Linux sürümüdür. |

## 2. WORKDIR

### Nedir
Konteynerin içindeki "şu anki klasörü" (Current Directory) belirler. Linux'taki `cd` komutunun karşılığıdır.

### Neden Kullanılır
Dosyaların rastgele yerlere (/ kök dizinine) dağılmasını engellemek ve düzenli çalışmak için.

| Teknoloji | Örnek Kullanım | Açıklama |
|-----------|----------------|----------|
| Genel | `WORKDIR /app` | Bundan sonra yazacağın her komut, konteyner içindeki /app klasöründe çalıştırılsın. |

## 3. COPY

### Nedir
Sizin bilgisayarınızdaki (Host) dosyaları, Konteynerin içine kopyalar.

### Neden Kullanılır
Kodlarınızı image'ın içine atmak için.

### Önemli Taktik
Genellikle iki aşamada yapılır (Önce paket dosyaları, sonra kodlar). Bu, Docker'ın önbellekleme (caching) yapabilmesi içindir.

| Teknoloji | Örnek Kullanım | Açıklama |
|-----------|----------------|----------|
| .NET | `COPY *.csproj .` | Önce sadece proje dosyasını kopyala (Bağımlılıkları yüklemek için). |
| React | `COPY package*.json .` | Önce sadece package.json'ı kopyala (npm install için). |
| Genel | `COPY . .` | Geri kalan her şeyi içeri at. |

## 4. RUN

### Nedir
Image hazırlanırken (Build aşamasında) çalıştırılacak komutlardır.

### Neden Kullanılır
Bağımlılıkları yüklemek, uygulamayı derlemek, dosya izinlerini ayarlamak için.

### Kritik Fark
Bu komut konteyner çalışırken **DEĞİL**, image oluşturulurken çalışır.

| Teknoloji | Örnek Kullanım | Açıklama |
|-----------|----------------|----------|
| .NET | `RUN dotnet restore` | NuGet paketlerini indirir. |
| .NET | `RUN dotnet publish -c Release -o out` | Uygulamayı yayınlanabilir (DLL) hale getirir. |
| React | `RUN npm install` | Node modüllerini indirir. |
| React | `RUN npm run build` | React kodunu tarayıcının anlayacağı HTML/JS/CSS'e dönüştürür. |

## 5. ENV

### Nedir
Konteyner içine Ortam Değişkeni (Environment Variable) tanımlar.

### Neden Kullanılır
Uygulamanın davranışını kod değiştirmeden ayarlamak için (Örn: Prodüksiyon modunda çalış, şu portu kullan vb.).

| Teknoloji | Örnek Kullanım | Açıklama |
|-----------|----------------|----------|
| .NET | `ENV ASPNETCORE_URLS=http://+:8080` | Uygulamanın 8080 portunu dinlemesini sağlar. |
| .NET | `ENV ASPNETCORE_ENVIRONMENT=Production` | Uygulamayı Canlı (Prod) moduna alır (Hata detaylarını gizler vb.). |

## 6. EXPOSE

### Nedir
Konteynerin hangi porttan yayın yapacağını belgeler.

### Neden Kullanılır
Bu aslında teknik bir zorunluluktan çok, Dockerfile'ı okuyan diğer geliştiricilere (veya Docker'a) "Hey, bu uygulama 80 portunu kullanıyor" bilgisini vermek içindir.

| Teknoloji | Örnek Kullanım | Açıklama |
|-----------|----------------|----------|
| Genel | `EXPOSE 8080` | Bu konteyner 8080 portundan trafiği kabul eder. |

## 7. CMD (veya ENTRYPOINT)

### Nedir
Konteyner ayağa kalktığında (Run aşamasında) çalışacak varsayılan komuttur.

### Neden Kullanılır
Uygulamayı başlatan "Start" tuşudur. Bir Dockerfile'da sadece bir tane CMD olabilir.

| Teknoloji | Örnek Kullanım | Açıklama |
|-----------|----------------|----------|
| .NET | `CMD ["dotnet", "MyApi.dll"]` | Derlenmiş .NET uygulamasını başlatır. |
| React (Dev) | `CMD ["npm", "start"]` | Geliştirme sunucusunu başlatır. |
| React (Prod) | `CMD ["nginx", "-g", "daemon off;"]` | React build dosyalarını sunmak için Nginx sunucusunu başlatır. |

## Özet: Bir .NET API için Akış Nasıl Olur?

Tüm bu komutlar bir araya geldiğinde mantıksal akış şöyledir:

1. **FROM:** .NET SDK'yı getir.
2. **WORKDIR:** /app klasörüne gir.
3. **COPY:** .csproj dosyasını at.
4. **RUN:** `dotnet restore` (Paketleri yükle).
5. **COPY:** Kalan tüm kodları at.
6. **RUN:** `dotnet publish` (Uygulamayı derle).
7. **ENV:** Ortam ayarlarını yap.
8. **CMD:** Uygulamayı çalıştır (`dotnet run`).